# Honeypot System Configuration

# Global Settings
global:
  log_level: INFO
  log_dir: /app/logs
  data_dir: /app/data
  interaction_level: medium  # low, medium, high

# Database Configuration
database:
  host: postgres
  port: 5432
  name: honeypot_db
  user: honeypot_user
  password: ${DB_PASSWORD}  # Use environment variable

# SSH Honeypot
ssh:
  enabled: true
  port: 2222
  host: 0.0.0.0
  banner: "SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.5"
  max_connections: 100
  session_timeout: 300
  record_sessions: true
  fake_users:
    - username: root
      password: root123
    - username: admin
      password: admin
    - username: ubuntu
      password: password

# HTTP/HTTPS Honeypot
http:
  enabled: true
  port: 8080
  ssl_port: 8443
  host: 0.0.0.0
  server_header: "Apache/2.4.41 (Ubuntu)"
  endpoints:
    - path: /admin
      type: login_panel
    - path: /api/v1
      type: vulnerable_api
    - path: /phpmyadmin
      type: database_admin
    - path: /.git/config
      type: exposed_config

# Database Honeypot
database_honeypot:
  enabled: true
  mysql:
    port: 3306
    host: 0.0.0.0
    version: "8.0.32-MySQL Community Server"
  postgres:
    port: 5432
    host: 0.0.0.0
    version: "14.5 (Ubuntu 14.5-1.pgdg22.04+1)"
  fake_databases:
    - customers
    - products
    - users

# SMB/FTP Honeypot
smb_ftp:
  enabled: true
  ftp:
    port: 2121
    host: 0.0.0.0
    banner: "Pure-FTPd"
    allow_anonymous: true
  smb:
    port: 4445
    host: 0.0.0.0
    workgroup: WORKGROUP
    server_name: FILESERVER

# Rate Limiting
rate_limiting:
  enabled: true
  max_connections_per_ip: 10
  time_window: 60  # seconds
  auto_block_threshold: 50
  block_duration: 3600  # seconds

# Threat Intelligence
threat_intel:
  geoip:
    enabled: true
    db_path: /app/data/GeoLite2-City.mmdb
  virustotal:
    enabled: false
    api_key: ${VIRUSTOTAL_API_KEY}
  abuseipdb:
    enabled: false
    api_key: ${ABUSEIPDB_API_KEY}
    report_threshold: 75

# Alerts
alerts:
  email:
    enabled: false
    smtp_host: smtp.gmail.com
    smtp_port: 587
    from: honeypot@example.com
    to: 
      - admin@example.com
    username: ${EMAIL_USERNAME}
    password: ${EMAIL_PASSWORD}
  slack:
    enabled: false
    webhook_url: ${SLACK_WEBHOOK_URL}
  webhook:
    enabled: false
    url: ${CUSTOM_WEBHOOK_URL}
  severity_threshold: high  # low, medium, high, critical

# Firewall Integration
firewall:
  enabled: false  # Requires root privileges
  auto_block: true
  whitelist:
    - 127.0.0.1
    - 192.168.1.0/24

# Dashboard
dashboard:
  enabled: true
  port: 5000
  host: 0.0.0.0
  secret_key: ${DASHBOARD_SECRET_KEY}
  username: admin
  password: ${DASHBOARD_PASSWORD}

# Analysis and ML
analysis:
  ml_enabled: true
  min_samples_for_training: 100
  retrain_interval: 86400  # seconds (24 hours)
  model_path: /app/models/classifier.pkl
